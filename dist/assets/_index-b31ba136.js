import{b as R,R as d,j as e,d as P,e as O,f as I,h as M,u as K,c as S,r as ie,i as re,k as de,l as ce,m as ue}from"./index-4357ab12.js";import{e as me,b as pe,f as z,A as L,a as Z,L as xe}from"./tour-e424c2d4.js";import{c as N,G as _}from"./iconBase-c81c388a.js";import{u as ge,M as E,A as F}from"./index.esm-b49c23d5.js";import{a as he,b as fe}from"./index.esm-ae470262.js";import{u as be,b as J,c as je,d as ye,a as ve}from"./room-1f4348b4.js";import{_ as k,e as y,s as v}from"./PulseLoader-f68eb128.js";import{b as we,c as Ne,d as D}from"./index.esm-f5933236.js";import{P as W}from"./PannellumVideo-cb2e9c90.js";const Se="",Ce=({isShow:a,onClose:n})=>{var m;const{idTour:l}=R(),{data:t}=ge(),{mutate:s,status:u}=be(),[c,o]=d.useState("Ruangan"),[g,i]=d.useState(null),h=r=>()=>i(r),x=()=>{n(),i(null)},b=()=>{if(!g){y({message:"Silahkan pilih gambar dahulu"});return}s({image_url:g,name:c,tour_id:String(l)},{onSuccess:()=>{v({message:"Behasil membuat ruangan baru"}),o("Ruangan"),i(null),x()},onError:()=>{y({message:"Gagal membuat ruangan"})}})};return e.jsx(E,{show:a,children:e.jsxs("div",{className:"bg-white rounded-sm px-4 w-5/12",children:[e.jsx("header",{className:"flex justify-end pt-3","aria-label":"modal-head",children:e.jsx("button",{disabled:u==="loading",type:"button",onClick:x,children:e.jsx(F,{className:"text-lg"})})}),e.jsxs("div",{className:"py-4","aria-label":"modal-body",children:[e.jsx("div",{className:"max-h-[330px] overflow-auto","aria-label":"images-container",children:e.jsx("div",{className:"grid grid-cols-2 gap-3 pr-2","aria-label":"images-wrapper",children:(m=t==null?void 0:t.data)==null?void 0:m.map((r,f)=>e.jsxs("div",{className:N("col-span-1 cursor-pointer relative"),onClick:h(r.file_path),children:[e.jsx("img",{src:Se+(r==null?void 0:r.thumbnail_path),alt:"avatar",loading:"lazy"}),g===r.file_path&&e.jsx("div",{className:"absolute inset-0 bg-black/60 z-10 flex justify-center items-center","aria-label":"selected-overlay",children:e.jsx("div",{className:"bg-white flex flex-col justify-center items-center rounded-full p-1",children:e.jsx(he,{className:"text-4xl text-blue-600"})})})]},f))})}),e.jsxs("div",{className:"mt-3 px-3","aria-label":"submit-container",children:[e.jsxs("div",{className:"text-white",children:[e.jsx("label",{htmlFor:"tour-name",className:"text-sm",children:"Tour name"}),e.jsx("input",{id:"tour-name",type:"text",className:N("border-gray-300 focus:border-gray-300 focus:ring-0 px-4 text-gray-900","focus:outline-none w-full tracking-wide rounded-md","placeholder:font-medium placeholder:tracking-wide placeholder:text-gray-400","peer/search"),value:c,onChange:r=>o(r.target.value)})]}),e.jsx("button",{disabled:u==="loading",type:"button",onClick:b,className:"bg-blue-500 relative text-white w-full px-3 py-2 rounded-md font-medium mt-4",children:u==="loading"?e.jsx(k,{color:"white",size:10}):"Simpan"})]})]})]})})},ke=d.memo(()=>{const{idTour:a}=R(),{data:n}=me({tour_id:String(a)}),[l,t]=d.useState("");d.useEffect(()=>{t((n==null?void 0:n.data.name)??"")},[n==null?void 0:n.data.name]);const{mutate:s,status:u}=pe(),c=()=>{const o=new FormData;o.append("name",l),o.append("_method","PUT"),s({tour_id:String(a),payload:o},{onSuccess:()=>{v({message:"Success update tour"})},onError:()=>{y({message:"Failed update tour"})}})};return e.jsxs("div",{className:"mt-3 px-3","aria-label":"submit",children:[e.jsxs("div",{className:"text-white",children:[e.jsx("label",{htmlFor:"tour-name",className:"text-sm",children:"Tour name"}),e.jsx("input",{id:"tour-name",type:"text",className:N("border-gray-300 focus:border-gray-300 focus:ring-0 px-4 text-gray-900","focus:outline-none w-full tracking-wide rounded-md","placeholder:font-medium placeholder:tracking-wide placeholder:text-gray-400","peer/search"),value:l,onChange:o=>t(o.target.value)})]}),e.jsx("button",{onClick:c,disabled:u==="loading",className:"bg-blue-500 relative text-white w-full px-3 py-2 rounded-md font-medium mt-4",children:u==="loading"?e.jsx(k,{color:"white",size:10}):"Simpan"})]})});P({key:"scene",default:[]});P({key:"scene-menu",default:null});const B=P({key:"viewer-coordinate",default:{pitch:0,yaw:0}}),G=P({key:"initial-viewer-coordinate",default:{pitch:0,yaw:0}}),ee=()=>{const a=O();return z({mutationFn:async l=>{const t=new FormData;return t.append("tour_id",String(l.tour_id)),t.append("room_id",String(l.room_id)),t.append("pitch",String(l.pitch)),t.append("yaw",String(l.yaw)),t.append("type",String(l.type)),t.append("text",String(l.text??"")),(await L.post("/api/hotspot",t)).data},onSuccess:()=>a.invalidateQueries(["HOTSPOTS"])})},U=()=>{const a=O();return z({mutationFn:async l=>(await L.post(`/api/hotspot/${l.hostpot_id}`,l.payload,{headers:{"content-type":"application/x-www-form-urlencoded"}})).data,onSuccess:()=>a.invalidateQueries(["HOTSPOTS"])})},A=()=>{const a=O();return z({mutationFn:async({hostpot_id:l})=>(await L.delete(`/api/hotspot/${l}`)).data,onSuccess:()=>a.invalidateQueries(["HOTSPOTS"])})};function _e(a){return _({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M288 144a110.94 110.94 0 0 0-31.24 5 55.4 55.4 0 0 1 7.24 27 56 56 0 0 1-56 56 55.4 55.4 0 0 1-27-7.24A111.71 111.71 0 1 0 288 144zm284.52 97.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400c-98.65 0-189.09-55-237.93-144C98.91 167 189.34 112 288 112s189.09 55 237.93 144C477.1 345 386.66 400 288 400z"}}]})(a)}function Re(a){return _({tag:"svg",attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"}}]})(a)}function Me(a){return _({tag:"svg",attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"}}]})(a)}function Te(a){return _({tag:"svg",attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"}}]})(a)}function Pe(a){return _({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 464c114.9 0 208-93.1 208-208S370.9 48 256 48 48 141.1 48 256s93.1 208 208 208zm0-244.5l-81.1 81.9c-7.5 7.5-19.8 7.5-27.3 0s-7.5-19.8 0-27.3l95.7-95.4c7.3-7.3 19.1-7.5 26.6-.6l94.3 94c3.8 3.8 5.7 8.7 5.7 13.7 0 4.9-1.9 9.9-5.6 13.6-7.5 7.5-19.7 7.6-27.3 0l-81-79.9z"}}]})(a)}function Ie(a){return _({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M416 277.333H277.333V416h-42.666V277.333H96v-42.666h138.667V96h42.666v138.667H416v42.666z"}}]})(a)}const He=({isShow:a,onClose:n})=>{const[l]=I(),{idTour:t}=R(),s=l.get("roomId"),{mutate:u,status:c}=ee(),o=M.useRecoilValue(B),g=M.useSetRecoilState(G),[i,h]=d.useState(""),x=m=>{h(m.target.value)},b=()=>{if(!i){y({message:"Nama label tidak boleh kosong"});return}u({pitch:o.pitch,yaw:o.yaw,type:"label",tour_id:String(t),room_id:String(s),text:i},{onSuccess:m=>{try{m.success&&v({message:"Berhasil menambah label"})}catch{y({message:"Gagal menambah label"})}finally{n()}},onError:()=>{y({message:"Gagal menambah label"})}}),g({pitch:o.pitch,yaw:o.yaw})};return e.jsx(E,{show:a,children:e.jsxs("div",{className:"bg-white rounded-sm px-4 w-3/12",children:[e.jsx("header",{className:"flex justify-end pt-3","aria-label":"modal-head",children:e.jsx("button",{disabled:c==="loading",type:"button",onClick:n,children:e.jsx(F,{className:"text-lg"})})}),e.jsx("div",{className:"mb-5","aria-label":"modal-body",children:e.jsxs("div",{className:"px-3","aria-label":"submit-container",children:[e.jsxs("div",{className:"text-black flex flex-col gap-1",children:[e.jsx("label",{htmlFor:"room-name",children:"Label name"}),e.jsx("input",{id:"room-name",type:"text",className:N("border-gray-300 focus:border-gray-300 focus:ring-0 px-4 text-gray-900","focus:outline-none w-full tracking-wide rounded-md","placeholder:font-medium placeholder:tracking-wide placeholder:text-gray-400","peer/search"),value:i,onChange:x})]}),e.jsx("button",{disabled:c==="loading",type:"button",onClick:b,className:"bg-blue-500 relative text-white w-full px-3 py-2 rounded-md font-medium mt-4",children:c==="loading"?e.jsx(k,{color:"white",size:10}):"Simpan"})]})})]})})},Oe=d.memo(()=>{const[a]=I(),{idTour:n}=R(),l=a.get("roomId"),{mutate:t,status:s}=ee(),{mutate:u,status:c}=J(),o=M.useRecoilValue(B),[g,i]=d.useState(null),[h,x]=d.useState(!1),b=d.useCallback(j=>()=>{if(j==="open")return x(!0);if(j==="close")return x(!1)},[]),m=M.useSetRecoilState(G),r=()=>{const j=new FormData;j.append("pitch",String(o.pitch)),j.append("yaw",String(o.yaw)),j.append("_method","PUT"),u({room_id:String(l),payload:j},{onSuccess:()=>{v({message:"Berhasil update initial view"})},onError:()=>{y({message:"Gagal update initial view"})}})},f=j=>()=>{i(j),t({pitch:o.pitch,yaw:o.yaw,type:j,tour_id:String(n),room_id:String(l)},{onSuccess:()=>{v({message:"Berhasil menambah hotspot"}),i(null)},onError:()=>{y({message:"Gagal menambah hotspot"}),i(null)}}),m({pitch:o.pitch,yaw:o.yaw})};return e.jsxs(e.Fragment,{children:[e.jsxs("section",{className:"text-white py-1","aria-label":"tools",children:[e.jsx("h3",{className:"text-[.85rem] font-semibold px-5 text-gray-300",children:"TOOLS"}),e.jsxs("div",{className:"mt-2 flex flex-col gap-[3px]","aria-label":"btn-action-contianer",children:[e.jsx("button",{className:N("flex items-center gap-3 px-5 w-full py-[10px]","bg-gray-700 hover:bg-gray-600 transition"),type:"button",onClick:f("info"),disabled:s==="loading",children:s==="loading"&&g==="info"?e.jsx(k,{color:"white",size:10,className:"mx-auto py-[5px]"}):e.jsxs(e.Fragment,{children:[e.jsx(Re,{className:"text-2xl"}),e.jsx("p",{children:"Tambah Text"})]})}),e.jsxs("button",{className:N("flex items-center gap-3 px-5 w-full py-[10px]","bg-gray-700 hover:bg-gray-600 transition"),onClick:b("open"),type:"button",children:[e.jsx(fe,{className:"text-2xl"}),e.jsx("p",{children:"Tambah Label"})]}),e.jsx("button",{className:N("flex items-center gap-3 px-5 w-full py-[10px] bg-gray-700 hover:bg-gray-600 transition"),type:"button",onClick:f("custom"),disabled:s==="loading",children:s==="loading"&&g==="custom"?e.jsx(k,{color:"white",size:10,className:"mx-auto py-[5px]"}):e.jsxs(e.Fragment,{children:[e.jsx(Pe,{className:"text-2xl"}),e.jsx("p",{children:"Tambah Hotspot"})]})}),e.jsx("button",{onClick:r,className:"flex items-center gap-3 px-5 w-full py-[10px] bg-gray-700",type:"button",disabled:c==="loading",children:c==="loading"?e.jsx(k,{color:"white",size:10,className:"mx-auto py-[5px]"}):e.jsxs(e.Fragment,{children:[e.jsx(_e,{className:"text-2xl"}),e.jsx("p",{children:"Tetapkan view awal"})]})})]})]}),e.jsx(He,{isShow:h,onClose:b("close")})]})});function ze(a){return _({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M231.4,44.34s0,.1,0,.15l-58.2,191.94a15.88,15.88,0,0,1-14,11.51q-.69.06-1.38.06a15.86,15.86,0,0,1-14.42-9.15l-35.71-75.39a4,4,0,0,1,.79-4.54l57.26-57.27a8,8,0,0,0-11.31-11.31L97.08,147.6a4,4,0,0,1-4.54.79l-75-35.53A16.37,16.37,0,0,1,8,97.36,15.89,15.89,0,0,1,19.57,82.84l191.94-58.2.15,0A16,16,0,0,1,231.4,44.34Z"}}]})(a)}const Le=d.memo(({onShowModal:a,onShowRoomPanel:n})=>{const[l]=I(),t=K(),{idTour:s}=R(),u=l.get("roomId"),{data:c}=Z({id:String(s)}),o=d.useMemo(()=>c==null?void 0:c.data,[c==null?void 0:c.data]),g=i=>()=>t(`/editor/${s}?roomId=${i}`);return e.jsxs("section",{className:"mt-2","aria-label":"ruangan",children:[e.jsxs("header",{className:"flex items-center justify-between pr-4",children:[e.jsx("h3",{className:"text-[.85rem] font-semibold px-5 text-gray-300",children:"RUANGAN"}),e.jsx("button",{className:"border border-white rounded-md p-[.4rem]",onClick:a,children:e.jsx(Ie,{className:"text-white"})})]}),e.jsx("div",{className:"max-h-[300px] overflow-auto mt-2","aria-label":"list-ruangan-container",children:e.jsx("div",{className:"text-white flex flex-col gap-[3px]","aria-label":"list-ruangan-wrapper",children:o==null?void 0:o.map((i,h)=>e.jsxs("button",{className:N("flex items-center justify-between px-5 w-full py-3 relative",String(u)===i.id?"bg-gray-600":"bg-gray-700"),type:"button",onClick:g(i.id),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ze,{className:"text-lg"}),e.jsx("p",{className:"",children:i.name})]}),e.jsx("div",{role:"button",tabIndex:0,onClick:n({room_id:i.id,room_name:i.name}),children:e.jsx(Me,{className:"text-2xl"})})]},h))})})]})});function Ee(a){return _({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",stroke:"#000",strokeWidth:"2",d:"M7,7 L17,17 M7,17 L17,7"}}]})(a)}const Fe=({isShowModalChangeName:a,tourId:n,roomId:l,roomName:t,coordinateX:s,coordinateY:u,onShowModalChangeNameRoom:c,onClose:o})=>{const g=d.useRef(null),i=K(),{mutate:h,status:x}=je(),b=()=>{confirm("Yakin ingin menghapus ruangan ini ?")&&h({room_id:l},{onSuccess:()=>{v({message:"Berhasil menghapus ruangan"}),i(`/editor/${n}`),o()},onError:()=>{y({message:"Gagal menghapus ruangan"})}})};return e.jsx(e.Fragment,{children:e.jsxs("div",{ref:g,onClick:m=>m.stopPropagation(),style:{position:"fixed",zIndex:"49",left:s+10,top:u+10,visibility:a?"hidden":"visible"},className:"bg-gray-100 rounded-md w-max shadow-md relative",children:[e.jsx("button",{type:"button",className:"absolute -top-4 -right-4 bg-gray-100 shadow-lg rounded-md",onClick:o,children:e.jsx(Ee,{className:"text-2xl"})}),e.jsxs("div",{className:"rounded-md overflow-hidden p-1 flex flex-col","aria-label":"panel-body",children:[e.jsx("button",{type:"button",className:"py-3 px-3 hover:bg-gray-200 transition rounded-md",onClick:c("show",{id:l,name:t}),children:e.jsxs("div",{className:"flex justify-start items-center gap-3",children:[e.jsx(Te,{}),e.jsx("p",{children:"Ubah nama Ruangan"})]})}),e.jsx("button",{onClick:b,disabled:x==="loading",type:"button",className:"py-3 px-3 hover:bg-gray-200 transition rounded-md",children:x==="loading"?e.jsx(k,{color:"skyblue",size:10}):e.jsxs("div",{className:"flex justify-start items-center gap-3",children:[e.jsx(we,{}),e.jsx("p",{children:"Hapus Ruangan"})]})})]})]})})},De=({isShow:a,room:n,onClose:l})=>{const{mutate:t,status:s}=J(),[u,c]=d.useState(n.name);d.useEffect(()=>{c(n.name)},[n.name]);const o=i=>{const h=i.target.value;h.length>=17||c(h)},g=()=>{if(u.length===0){y({message:"Nama tidak boleh kosong!"});return}const i=new FormData;i.append("name",u),i.append("_method","PUT"),t({room_id:n.id,payload:i},{onSuccess:()=>{v({message:"Behasil update nama ruangan"}),l()},onError:()=>{y({message:"Gagal update nama ruangan"})}})};return e.jsx(E,{show:a,children:e.jsxs("div",{className:"bg-white rounded-md px-4 w-4/12",children:[e.jsx("header",{className:"flex justify-end pt-3","aria-label":"modal-head",children:e.jsx("button",{disabled:s==="loading",type:"button",onClick:l,children:e.jsx(F,{className:"text-lg"})})}),e.jsx("div",{className:"mb-5","aria-label":"modal-body",children:e.jsxs("div",{className:"px-3","aria-label":"submit-container",children:[e.jsxs("div",{className:"text-black flex flex-col gap-1",children:[e.jsx("label",{htmlFor:"room-name",children:"Room name"}),e.jsx("input",{id:"room-name",type:"text",className:N("border-gray-300 focus:border-gray-300 focus:ring-0 px-4 text-gray-900","focus:outline-none w-full tracking-wide rounded-md","placeholder:font-medium placeholder:tracking-wide placeholder:text-gray-400","peer/search"),value:u,onChange:o})]}),e.jsx("button",{disabled:s==="loading",type:"button",onClick:g,className:"bg-blue-500 relative text-white w-full px-3 py-2 rounded-md font-medium mt-4",children:s==="loading"?e.jsx(k,{color:"white",size:10}):"Simpan Perubahan"})]})})]})})},X={addRoom:!1},Be=()=>{const{idTour:a}=R(),[n,l]=d.useState(X),[t,s]=d.useState({id:null,name:""}),[u,c]=d.useState({x:0,y:0}),[o,g]=d.useState(!1),i=(r,f)=>()=>{if(r==="show"){g(!0),s({id:f==null?void 0:f.id,name:f==null?void 0:f.name});return}r==="close"&&(g(!1),s({id:null,name:""}))},h=d.useCallback(r=>()=>{switch(r){case"addRoom":l({addRoom:!0});break}},[]),x=d.useCallback(({room_id:r,room_name:f})=>j=>{j.stopPropagation();const H={x:j.clientX,y:j.clientY};s({id:r,name:f}),c(H)},[]),b=()=>s({id:null,name:""}),m=d.useCallback(()=>l(X),[]);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:N("col-span-2 bg-gray-800 pt-2 pb-5","min-h-[calc(100vh_-_60px)] flex flex-col justify-between"),children:[e.jsxs("div",{"aria-label":"top-side",children:[e.jsx(Oe,{}),e.jsx(Le,{onShowModal:h("addRoom"),onShowRoomPanel:x})]}),e.jsx(ke,{})]}),t.id&&e.jsx(Fe,{isShowModalChangeName:o,tourId:String(a),roomId:t.id,roomName:t.name,coordinateX:u.x,coordinateY:u.y,onShowModalChangeNameRoom:i,onClose:b}),e.jsx(De,{isShow:o,room:{id:t.id,name:t.name},onClose:i("close")}),e.jsx(Ce,{isShow:n.addRoom,onClose:m})]})};var ae={},T=S&&S.__assign||function(){return T=Object.assign||function(a){for(var n,l=1,t=arguments.length;l<t;l++){n=arguments[l];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(a[s]=n[s])}return a},T.apply(this,arguments)},Ge=S&&S.__createBinding||(Object.create?function(a,n,l,t){t===void 0&&(t=l);var s=Object.getOwnPropertyDescriptor(n,l);(!s||("get"in s?!n.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return n[l]}}),Object.defineProperty(a,t,s)}:function(a,n,l,t){t===void 0&&(t=l),a[t]=n[l]}),Ue=S&&S.__setModuleDefault||(Object.create?function(a,n){Object.defineProperty(a,"default",{enumerable:!0,value:n})}:function(a,n){a.default=n}),Ae=S&&S.__importStar||function(a){if(a&&a.__esModule)return a;var n={};if(a!=null)for(var l in a)l!=="default"&&Object.prototype.hasOwnProperty.call(a,l)&&Ge(n,a,l);return Ue(n,a),n},Ve=S&&S.__rest||function(a,n){var l={};for(var t in a)Object.prototype.hasOwnProperty.call(a,t)&&n.indexOf(t)<0&&(l[t]=a[t]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,t=Object.getOwnPropertySymbols(a);s<t.length;s++)n.indexOf(t[s])<0&&Object.prototype.propertyIsEnumerable.call(a,t[s])&&(l[t[s]]=a[t[s]]);return l};Object.defineProperty(ae,"__esModule",{value:!0});var qe=Ae(ie),Q=de,Ye=re,$e=(0,Ye.createAnimation)("ClipLoader","0% {transform: rotate(0deg) scale(1)} 50% {transform: rotate(180deg) scale(0.8)} 100% {transform: rotate(360deg) scale(1)}","clip");function We(a){var n=a.loading,l=n===void 0?!0:n,t=a.color,s=t===void 0?"#000000":t,u=a.speedMultiplier,c=u===void 0?1:u,o=a.cssOverride,g=o===void 0?{}:o,i=a.size,h=i===void 0?35:i,x=Ve(a,["loading","color","speedMultiplier","cssOverride","size"]),b=T({background:"transparent !important",width:(0,Q.cssValue)(h),height:(0,Q.cssValue)(h),borderRadius:"100%",border:"2px solid",borderTopColor:s,borderBottomColor:"transparent",borderLeftColor:s,borderRightColor:s,display:"inline-block",animation:"".concat($e," ").concat(.75/c,"s 0s infinite linear"),animationFillMode:"both"},g);return l?qe.createElement("span",T({style:b},x)):null}var V=ae.default=We;const Xe=({hotspot:a,coordinateX:n,coordinateY:l,forceRenderPanorana:t,onClose:s})=>{const{idTour:u}=R(),{data:c}=Z({id:String(u)}),{mutate:o,status:g}=U(),{mutate:i,status:h}=A(),[x,b]=d.useState((a==null?void 0:a.room_link_id)??null),m=()=>{const f=new FormData;f.append("room_link_id",String(x)),f.append("_method","PUT"),o({hostpot_id:a.id,payload:f},{onSuccess:()=>{v({message:"Berhasil update hotspot"}),s(),b(null)},onError:()=>{y({message:"Gagal update hotspot"}),s(),b(null)}})},r=()=>{confirm("Yakin ingin menghapus hotspot ini ?")&&i({hostpot_id:a.id},{onSuccess:()=>{s(),v({message:"Berhasil menghapus hotspot"}),t()},onError:()=>{y({message:"Gagal menghapus hotspot"})}})};return e.jsxs(e.Fragment,{children:[e.jsx("div",{onClick:f=>f.stopPropagation(),style:{position:"fixed",zIndex:"1000",left:n+30,top:l+10},className:"bg-white/90 rounded-md p-3 w-3/12",children:e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Select target room"}),e.jsx("div",{className:"my-3",children:c==null?void 0:c.data.map((f,j)=>e.jsx("button",{type:"button",className:N("bg-gray-300 transition w-full text-left px-2 py-2",f.id===x?"bg-gray-400 text-white":""),onClick:()=>{b(f.id)},children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{children:f.name}),(a==null?void 0:a.room_link_id)===f.id&&e.jsx(Ne,{className:"text-2xl"})]})},j))})]}),e.jsxs("div",{className:"mt-2 flex justify-between items-center ",children:[e.jsx("div",{children:(g==="loading"||h==="loading")&&e.jsx(V,{size:16})}),e.jsxs("div",{className:"mt-2 flex justify-end items-center gap-x-4",children:[e.jsx("button",{onClick:m,disabled:g==="loading",type:"button",children:"Save"}),e.jsx("button",{onClick:r,className:"w-max",type:"button",disabled:h==="loading",children:e.jsx(D,{className:"text-xl"})})]})]})]})}),e.jsx("div",{onClick:s,className:"absolute inset-0 z-[51] bg-transparent","aria-label":"overlay"})]})},Qe=({hotspot:a,coordinateX:n,coordinateY:l,forceRenderPanorana:t,onClose:s})=>{const u=d.useRef(null),{mutate:c,status:o}=U(),{mutate:g,status:i}=A(),[h,x]=d.useState((a==null?void 0:a.text)??"");d.useEffect(()=>{x((a==null?void 0:a.text)??"")},[a==null?void 0:a.text]);const b=()=>{const r=new FormData;r.append("text",h),r.append("_method","PUT"),c({hostpot_id:String(a.id),payload:r},{onSuccess:()=>{v({message:"Berhasil update hotspot"}),s()},onError:()=>{y({message:"Gagal update hotspot"}),s()}})},m=()=>{confirm("Yakin ingin menghapus hotspot ini ?")&&g({hostpot_id:String(a.id)},{onSuccess:()=>{s(),v({message:"Berhasil menghapus hotspot"}),t()},onError:()=>{y({message:"Gagal menghapus hotspot"})}})};return e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:u,onClick:r=>r.stopPropagation(),style:{position:"fixed",zIndex:"1000",left:n+30,top:l+10},className:"bg-white/90 rounded-md p-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{htmlFor:"information-text",className:"font-medium",children:"Information text"}),e.jsx("input",{id:"information-text",type:"text",className:"rounded-md",value:h,onChange:r=>x(r.target.value)})]}),e.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[e.jsx("div",{children:(o==="loading"||i==="loading")&&e.jsx(V,{size:16})}),e.jsxs("div",{className:"flex justify-center items-center gap-x-3",children:[e.jsx("button",{disabled:o==="loading",type:"button",onClick:b,children:"Save"}),e.jsx("button",{disabled:i==="loading",onClick:m,type:"button",className:"w-max",children:e.jsx(D,{className:"text-xl"})})]})]})]})}),e.jsx("div",{onClick:s,className:"absolute inset-0 z-[51] bg-transparent","aria-label":"overlay"})]})},Ke=({hotspot:a,coordinateX:n,coordinateY:l,forceRenderPanorana:t,onClose:s})=>{const u=d.useRef(null),{mutate:c,status:o}=U(),{mutate:g,status:i}=A(),[h,x]=d.useState((a==null?void 0:a.text)??"");d.useEffect(()=>{x((a==null?void 0:a.text)??"")},[a==null?void 0:a.text]);const b=()=>{const r=new FormData;r.append("text",h),r.append("_method","PUT"),c({hostpot_id:a.id,payload:r},{onSuccess:()=>{t(),s(),v({message:"Berhasil update label"})},onError:()=>{y({message:"Gagal update label"}),s()}})},m=()=>{confirm("Yakin ingin menghapus label ini ?")&&g({hostpot_id:a.id},{onSuccess:()=>{s(),v({message:"Berhasil menghapus label"}),t()},onError:()=>{y({message:"Gagal menghapus label"})}})};return e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:u,onClick:r=>r.stopPropagation(),style:{position:"fixed",zIndex:"1000",left:n+30,top:l+10},className:"bg-white/90 rounded-md p-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{htmlFor:"information-text",className:"font-medium",children:"Label text"}),e.jsx("input",{id:"information-text",type:"text",className:"rounded-md",value:h,onChange:r=>x(r.target.value)})]}),e.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[e.jsx("div",{children:(o==="loading"||i==="loading")&&e.jsx(V,{size:16})}),e.jsxs("div",{className:"flex justify-center items-center gap-x-3",children:[e.jsx("button",{disabled:o==="loading",type:"button",onClick:b,children:"Save"}),e.jsx("button",{disabled:i==="loading",onClick:m,type:"button",className:"w-max",children:e.jsx(D,{className:"text-xl"})})]})]})]})}),e.jsx("div",{onClick:s,className:"absolute inset-0 z-[51] bg-transparent","aria-label":"overlay"})]})},Ze="",Je=()=>{const[a]=I(),{data:n,status:l}=ye({id:String(a.get("roomId"))}),{data:t}=ve({id:String(a.get("roomId"))}),s=d.useRef(null),u=ce(G),c=ue(B),[o,g]=d.useState(null),[i,h]=d.useState(null),[x,b]=d.useState({x:0,y:0}),m=d.useMemo(()=>n==null?void 0:n.data,[n==null?void 0:n.data,a.get("roomId")]),r=d.useMemo(()=>t==null?void 0:t.data.find(C=>C.id===i),[t,i]),f=({type:p,id:C})=>()=>{g(p),h(C)},j=d.useCallback(()=>{g(null),h(null)},[]),[H,te]=d.useState(Math.random()),se=p=>{p.preventDefault(),b({x:p.clientX,y:p.clientY})},ne=()=>{var w,q,Y,$;const p=(q=(w=s==null?void 0:s.current)==null?void 0:w.getViewer())==null?void 0:q.getPitch(),C=($=(Y=s==null?void 0:s.current)==null?void 0:Y.getViewer())==null?void 0:$.getYaw();c({pitch:p,yaw:C})},le=d.useCallback((p,C)=>{p.classList.add("custom-tooltip");const w=document.createElement("span");w.innerHTML=C.label,p.appendChild(w),w.style.width=w.scrollWidth-20+"px",w.style.marginLeft=-(w.scrollWidth-p.offsetWidth)/2+"px",w.style.marginTop=-w.scrollHeight-12+"px"},[t,o,i]),oe=p=>{if(p==="info")return"info-custom-style";if(p==="label")return"label-custom-style"};return e.jsxs("div",{className:"col-span-10 h-[calc(100vh_-_60px)] overflow-scroll relative",onClick:se,children:[e.jsx(W,{ref:s,title:m==null?void 0:m.name,width:"100%",height:"90vh",image:l==="success"?Ze+(m==null?void 0:m.image_url):"",autoLoad:!0,hfov:100,haov:360,vaov:180,pitch:u.pitch??(m==null?void 0:m.pitch),yaw:u.yaw??(m==null?void 0:m.yaw),hotspotDebug:!0,onRender:ne,children:t==null?void 0:t.data.map((p,C)=>e.jsx(W.Hotspot,{type:"custom",pitch:p==null?void 0:p.pitch,yaw:p==null?void 0:p.yaw,autoRotate:0,tooltip:p.type==="label"&&le,tooltipArg:{label:p.text},cssClass:oe(p.type),handleClick:f({id:String(p==null?void 0:p.id),type:p==null?void 0:p.type})},C))},H),o==="info"&&i&&e.jsx(Qe,{hotspot:r,coordinateX:x.x,coordinateY:x.y,forceRenderPanorana:()=>s.current.forceRender(),onClose:j}),o==="label"&&i&&e.jsx(Ke,{hotspot:r,coordinateX:x.x,coordinateY:x.y,forceRenderPanorana:()=>te(Math.random()),onClose:j}),o==="custom"&&i&&e.jsx(Xe,{hotspot:r,coordinateX:x.x,coordinateY:x.y,forceRenderPanorana:()=>s.current.forceRender(),onClose:j})]})};function da(){return e.jsx(xe,{children:e.jsxs("div",{className:"grid grid-cols-12","aria-label":"editor-container",children:[e.jsx(Be,{}),e.jsx(Je,{})]})})}export{da as default};
